<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Automating Your Army 🔁</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<h1 data-number="5" id="automating-your-army"><span
class="header-section-number">5</span> Automating Your Army 🔁</h1>
<hr />
<h2 data-number="5.1" id="the-story-so-far-2"><span
class="header-section-number">5.1</span> The Story So Far…</h2>
<p>You’ve assembled a mighty army and organized it into a deck. You even
figured out how to find the fastest card. But… it was a bit clumsy,
wasn’t it? You had to write a separate <code>if</code> statement for
<code>deck[2]</code>, <code>deck[3]</code>, and so on. If your deck had
50 cards, your code would be huge and fragile!</p>
<p>That kind of repetitive work is for computers, not for master
summoners like you. Today, you’ll learn the automation spell that tells
the computer: “Do this for every card in the deck!”</p>
<h2 data-number="5.2"
id="the-mission-what-well-accomplish-today-3"><span
class="header-section-number">5.2</span> The Mission: What We’ll
Accomplish Today</h2>
<p>By the end of this session, you will have upgraded your code with
<strong>loops</strong>. Your new program will be able to:</p>
<ol type="1">
<li>Display every single card in your deck with just a few lines of
code.</li>
<li>Find the fastest card in the deck, no matter if there are 3 cards or
300, using one small, elegant block of code.</li>
</ol>
<h2 data-number="5.3" id="the-spellbook-new-tools-well-learn-3"><span
class="header-section-number">5.3</span> The Spellbook: New Tools We’ll
Learn</h2>
<p><strong>1. <code>for</code> Loops: The Repetition Spell</strong></p>
<p>A <strong><code>for</code> loop</strong> is a way to repeat a block
of code over and over again. It’s one of the most powerful tools a
programmer has.</p>
<p><strong>2. The Numeric <code>for</code> Loop (The
Countdown)</strong></p>
<p>This is the simplest type of loop. You give it a starting number and
an ending number, and it runs the code inside for each number in
between.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- This loop will run 5 times.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- The variable &#39;i&#39; will be 1, then 2, then 3, all the way to 5.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="va">i</span> <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span> <span class="cf">do</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span><span class="op">(</span><span class="st">&quot;This is repetition number: &quot;</span> <span class="op">..</span> <span class="va">i</span><span class="op">)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div>
<p>Think of <code>i</code> as a temporary counter variable that the loop
manages for you.</p>
<p><strong>3. The <code>ipairs</code> Loop (The Grand
Inspection)</strong></p>
<p>This is the perfect tool for going through a list, like our deck. The
“i” in <code>ipairs</code> stands for “index,” because it goes through
your list in numerical index order (1, 2, 3…).</p>
<p>It gives you two variables for each trip through the loop: the item’s
position (<code>index</code>) and the item itself
(<code>value</code>).</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- &#39;ipairs(deck)&#39; tells the loop we want to inspect the deck.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- For each card, &#39;index&#39; will be its position (1, 2, 3...)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- and &#39;card&#39; will be the actual card table itself!</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="va">index</span><span class="op">,</span> <span class="va">card</span> <span class="kw">in</span> <span class="fu">ipairs</span><span class="op">(</span><span class="va">deck</span><span class="op">)</span> <span class="cf">do</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span><span class="op">(</span><span class="st">&quot;Checking card #&quot;</span> <span class="op">..</span> <span class="va">index</span> <span class="op">..</span> <span class="st">&quot; which is: &quot;</span> <span class="op">..</span> <span class="va">card</span><span class="op">.</span><span class="va">name</span><span class="op">)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div>
<p>This is much cleaner than writing <code>deck[1]</code>,
<code>deck[2]</code>, etc., because the loop hands you each card
automatically!</p>
<h2 data-number="5.4" id="your-quest-the-grand-inspection"><span
class="header-section-number">5.4</span> Your Quest: The Grand
Inspection</h2>
<p>Time to put this new power to use and upgrade your old code.</p>
<p><strong>Part A: Display the Whole Deck</strong></p>
<ol type="1">
<li>In your <code>main.lua</code> file, right after you
<code>require</code> your deck of cards, write an <code>ipairs</code>
loop.</li>
<li>Inside the loop, use <code>print()</code> to display the name and
stats of each card.</li>
<li>Run it! You should see all the cards in your deck printed out, one
after the other.</li>
</ol>
<p><strong>Part B: The Ultimate Speed Trial</strong></p>
<ol type="1">
<li>Now, let’s refactor the “Speed Trial” logic from last time.</li>
<li>Start by creating your <code>fastest_card_so_far</code> variable,
initializing it with <code>deck[1]</code>.</li>
<li>Create an <code>ipairs</code> loop to go through the deck.</li>
<li>Inside the loop, write a single <code>if</code> statement that
compares the current <code>card.speed</code> (from the loop) with
<code>fastest_card_so_far.speed</code>.</li>
<li>If the current <code>card</code> is faster, update
<code>fastest_card_so_far</code> to be the current
<code>card</code>.</li>
<li>After the loop is finished, print the name of the winner. Your new
code should be tiny compared to the old way, but much more
powerful!</li>
</ol>
<hr />
<h2 data-number="5.5" id="side-quest-the-barbarians-rage"><span
class="header-section-number">5.5</span> Side Quest: The Barbarian’s
Rage ⚔️</h2>
<p>Let’s practice the numeric loop with a quick, fun challenge.</p>
<p><strong>The Task:</strong> A Barbarian character has a ‘Rage’ ability
that lets him attack 5 times in a row. Write a <strong>numeric
<code>for</code> loop</strong> that prints “Smash!” to the console 5
times.</p>
<hr />
<h2 data-number="5.6" id="the-troubleshooting-scroll-1"><span
class="header-section-number">5.6</span> The Troubleshooting Scroll</h2>
<ul>
<li><p><strong>My loop only runs once, or not at all!</strong></p>
<ul>
<li><strong>Check:</strong> Is your deck table empty? An
<code>ipairs</code> loop won’t run if there’s nothing in the table to
loop over. Make sure your <code>require("cards")</code> is working and
your deck has cards in it.</li>
</ul></li>
<li><p><strong>I get an error like
<code>attempt to index a nil value (field 'speed')</code> inside my
loop.</strong></p>
<ul>
<li><strong>Meaning:</strong> The <code>card</code> variable you’re
trying to use inside the loop is empty (<code>nil</code>).</li>
<li><strong>Check:</strong> Make sure your list only contains valid card
tables. If you have an accidental <code>nil</code> value in your list
(e.g., <code>local deck = { goblin, golem, nil, elf }</code>), the loop
will run but crash when it gets to the empty spot.</li>
</ul></li>
<li><p><strong>In my Speed Trial, the first card always
wins.</strong></p>
<ul>
<li><strong>Check:</strong> Look at your <code>if</code> statement
inside the loop. Are you comparing the loop’s <code>card.speed</code> to
the <code>fastest_card_so_far.speed</code>? A common mistake is to
accidentally compare a card to itself or use the wrong variable. The
line should be
<code>if card.speed &gt; fastest_card_so_far.speed then ...</code>.</li>
</ul></li>
</ul>
<nav id="sitenav">
<div class="sitenav">
<span class="navlink next">
<span class="navlink-label">Next Up:</span> <a href="6-creating-reusable-spells.html" accesskey="n" rel="next">Creating Reusable Spells 🪄</a>
</span>
<span class="navlink">
</span>
</div>
<div class="sitenav">
<span class="navlink top">
<a href="index.html" accesskey="t" rel="top">Code &amp; Sorcery: A Lua Card Game Quest</a>
</span>
</div>
</nav>
</body>
</html>
